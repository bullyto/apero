<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ApÃ©ro de Nuit 66</title>

  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0b1c2d">

  <link rel="stylesheet" href="style.css">
</head>

<body>

  <!-- HEADER -->
  <header class="header">
    <img src="logo.png" alt="ApÃ©ro de Nuit">
  </header>

  <!-- ZONE CENTRÃ‰E -->
  <main class="center-zone">

    <button id="goBtn" class="btn primary">
      Commander
    </button>

    <button id="installBtn" class="btn secondary">
      Ajouter lâ€™app
      <span id="newBadge">Nouveau</span>
    </button>

  </main>

  <!-- TOAST -->
  <div id="toast"></div>

<script>
/* =========================
   NAVIGATION
========================= */
document.getElementById("goBtn").onclick = () => {
  window.location.href = "https://aperodenuit.com/commander";
};

/* =========================
   PWA INSTALL LOGIC (NE PAS TOUCHER)
========================= */
let deferredPrompt = null;

window.addEventListener("beforeinstallprompt", (e) => {
  e.preventDefault();
  deferredPrompt = e;
});

/* Standalone detection */
function isStandalone() {
  return window.matchMedia("(display-mode: standalone)").matches
    || window.navigator.standalone === true;
}

/* Toast */
const toast = document.getElementById("toast");
function showToast(msg){
  toast.textContent = msg;
  toast.classList.add("show");
  setTimeout(() => toast.classList.remove("show"), 2500);
}

/* App installÃ©e */
window.addEventListener("appinstalled", () => {
  showToast("ðŸŽ‰ ApÃ©ro de Nuit est installÃ© !");
});

/* Click install */
document.getElementById("installBtn").addEventListener("click", async () => {

  if (isStandalone()) {
    showToast("ðŸ“² Lâ€™app est dÃ©jÃ  installÃ©e");
    return;
  }

  if (deferredPrompt) {
    deferredPrompt.prompt();
    await deferredPrompt.userChoice;
    deferredPrompt = null;
    return;
  }

  alert(
    "Installation indisponible.\n\n" +
    "â€¢ Utilise Chrome (Android)\n" +
    "â€¢ Ou Safari (iPhone)\n" +
    "â€¢ Ã‰vite Facebook / Instagram"
  );
});
</script>

</body>
</html>

<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>ApÃ©ro de Nuit 66</title>

  <style>
    :root{
      --blue:#0b1c2d;
      --sky:#5db7ee;
      --text:#0b1c2d;
    }
    *{box-sizing:border-box}

    body{
      margin:0;
      height:100dvh;
      display:flex;
      flex-direction:column;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:#fff;
      color:var(--text);
      overflow:hidden;
    }

    /* HEADER */
    .top{background:var(--blue);padding-bottom:8px}
    .top img{width:100%;max-height:26vh;object-fit:contain;display:block}

    /* TITRE */
    .mid{text-align:center;padding:18px 14px 6px}
    .mid h1{
      margin:0;
      font-size:clamp(26px,6vw,40px);
      color:var(--sky);
      font-weight:900;
    }
    .brand66{position:relative;display:inline-block}
    .brand66 .reg{
      position:absolute;
      top:-0.2em;
      right:-0.4em;
      font-size:1em;
      font-weight:800;
    }

    /* ZONE BOUTEILLES */
    .stage{flex:1;display:flex;justify-content:center;padding:12px}
    .bottleWrap{
      position:relative;
      width:min(520px,96vw);
      min-height:60vh;
      display:flex;
      justify-content:center;
      align-items:flex-start;
    }
    .bottleWrap img{
      position:absolute;
      max-height:56vh;
      max-width:100%;
      opacity:0;
      transition:opacity .4s ease;
    }
    .bottleWrap img.active{opacity:1}

    /* BOUTONS */
    .btnStack{
      position:absolute;
      bottom:14vh;
      left:50%;
      transform:translateX(-50%);
      width:min(420px,86vw);
      z-index:5;
    }
    .btn{
      width:100%;
      border:none;
      border-radius:16px;
      padding:14px;
      font-size:18px;
      font-weight:900;
      cursor:pointer;
    }
    .btn + .btn{margin-top:10px}
    .btn.primary{background:var(--sky);color:#fff}
    .btn.secondary{
      background:rgba(255,255,255,.85);
      color:#0b1c2d;
      border:1px solid rgba(11,28,45,.25);
    }

    /* MODALE */
    .modal{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      background:rgba(0,0,0,.55);
      z-index:999;
    }
    .modal.open{display:flex}

    .sheet{
      width:min(520px,94vw);
      background:#fff;
      border-radius:22px;
      box-shadow:0 18px 60px rgba(0,0,0,.25);
      padding:18px 16px 14px;
    }

    .sheetHead{display:flex;gap:12px;margin-bottom:10px}
    .sheetIcon{
      width:40px;height:40px;border-radius:14px;
      display:flex;align-items:center;justify-content:center;
      background:rgba(93,183,238,.18);
      font-size:20px;
    }

    .sheet h3{margin:0;font-size:18px;color:var(--blue)}
    .sheet p{margin:10px 0;color:rgba(0,0,0,.75);font-size:14px}

    .step{
      background:rgba(11,28,45,.06);
      border-radius:16px;
      padding:10px 12px;
      margin:10px 0;
      font-size:14px;
    }

    .modalActions{
      display:flex;
      gap:10px;
      justify-content:flex-end;
      margin-top:14px;
      flex-wrap:wrap;
    }

    .okBtn,.copyBtn{
      border:none;
      border-radius:14px;
      padding:12px 16px;
      font-weight:900;
      cursor:pointer;
    }

    .okBtn{background:var(--sky);color:#fff}
    .copyBtn{
      background:rgba(93,183,238,.18);
      color:var(--blue);
    }

    .copied{
      font-size:13px;
      color:green;
      margin-top:6px;
      display:none;
    }
  </style>
</head>

<body>

<header class="top">
  <img src="assets/logo-header.png" alt="">
</header>

<section class="mid">
  <h1>APÃ‰RO DE NUIT <span class="brand66">66<span class="reg">Â®</span></span></h1>
</section>

<main class="stage">
  <div class="bottleWrap" id="bottles">
    <img src="assets/bottle1.png" class="active">
    <img src="assets/bottle2.png">
    <img src="assets/bottle3.png">
    <img src="assets/bottle4.png">
    <img src="assets/bottle5.png">
    <img src="assets/bottle6.png">
    <img src="assets/bottle7.png">

    <div class="btnStack">
      <button class="btn primary" id="goBtn">Commander</button>
      <button class="btn secondary" id="installBtn">Ajouter lâ€™app</button>
    </div>
  </div>
</main>

<!-- MODALE -->
<div class="modal" id="helpModal">
  <div class="sheet">
    <div class="sheetHead">
      <div class="sheetIcon">ðŸ“²</div>
      <div>
        <h3 id="helpTitle"></h3>
        <p id="helpIntro"></p>
      </div>
    </div>

    <div class="step" id="helpSteps"></div>
    <div class="copied" id="copiedMsg">âœ… Lien copiÃ©</div>

    <div class="modalActions">
      <button class="copyBtn" id="copyLinkBtn" style="display:none">Copier le lien</button>
      <button class="okBtn" id="closeHelp">OK</button>
    </div>
  </div>
</div>

<script>
  // Commander
  document.getElementById("goBtn").onclick = () => {
    window.location.href = "https://aperodenuit.com/commander";
  };

  // DÃ©filement bouteilles
  const imgs = document.querySelectorAll("#bottles img");
  let i = 0;
  setInterval(() => {
    imgs[i].classList.remove("active");
    i = (i + 1) % imgs.length;
    imgs[i].classList.add("active");
  }, 2000);

  // DÃ©tection
  const ua = navigator.userAgent || "";
  const isFB = /FBAN|FBAV|FB_IAB|FB4A|FB4i|Instagram/i.test(ua);
  const isIOS = /iPhone|iPad|iPod/i.test(ua);
  const isSafari = /^((?!chrome|android).)*safari/i.test(ua);

  let deferredPrompt = null;
  window.addEventListener("beforeinstallprompt", e => {
    e.preventDefault();
    deferredPrompt = e;
  });

  const modal = document.getElementById("helpModal");
  const title = document.getElementById("helpTitle");
  const intro = document.getElementById("helpIntro");
  const steps = document.getElementById("helpSteps");
  const copyBtn = document.getElementById("copyLinkBtn");
  const copiedMsg = document.getElementById("copiedMsg");

  function openModal(t,i,s,showCopy=false){
    title.innerHTML=t;
    intro.innerHTML=i;
    steps.innerHTML=s;
    copyBtn.style.display = showCopy ? "inline-block" : "none";
    copiedMsg.style.display="none";
    modal.classList.add("open");
  }

  document.getElementById("closeHelp").onclick = () => modal.classList.remove("open");
  modal.onclick = e => { if(e.target===modal) modal.classList.remove("open"); };

  document.getElementById("installBtn").onclick = async () => {

    if (isFB) {
      openModal(
        "Installer lâ€™app",
        "Facebook / Instagram ne permet pas lâ€™installation.",
        "Clique sur <strong>Copier le lien</strong>, puis ouvre-le dans <strong>Chrome</strong> ou <strong>Safari</strong>.",
        true
      );
      return;
    }

    if (deferredPrompt) {
      deferredPrompt.prompt();
      deferredPrompt = null;
      return;
    }

    if (isIOS && isSafari) {
      openModal(
        "Installer lâ€™app",
        "Sur iPhone, lâ€™installation se fait manuellement.",
        "Bouton <strong>Partager</strong> â†’ <strong>Sur lâ€™Ã©cran dâ€™accueil</strong>"
      );
      return;
    }

    openModal(
      "Installation indisponible",
      "Essaie avec Chrome ou Safari.",
      ""
    );
  };

  copyBtn.onclick = async () => {
    await navigator.clipboard.writeText(window.location.href);
    copiedMsg.style.display="block";
  };
</script>

</body>
</html>
